---
import { cn } from '@/lib/utils';
import hexRgb from 'hex-rgb';

interface AstroProps {
  sizeClasses?: string;
}

const { sizeClasses = 'size-[500px]' } = Astro.props as AstroProps;

const colorLogo = hexRgb('#F0047F', { format: 'array' });
---

<div class={cn('relative', sizeClasses)}>
  <div
    class={cn('absolute', sizeClasses)}
    style="mask: url(data:image/svg+xml,%3Csvg%20width%3D%221000%22%20height%3D%221000%22%20viewBox%3D%220%200%201000%201000%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20clip-path%3D%22url%28%23clip0_1_2%29%22%3E%3Cpath%20d%3D%22M1000%200V500C1000%20776.477%20776.477%201000%20500%201000C223.52%201000%200%20776.477%200%20500C0%20223.52%20223.52%200%20500%200H1000ZM108.312%20527.188L108.691%20533.055C122.656%20726.277%20278.816%20880.605%20472.812%20891.688V527.188H108.312ZM494.008%20527.188V891.688L499.387%20891.309C676.508%20877.344%20817.977%20721.188%20828.133%20527.188H494.008ZM494.008%20171.43V505.992H828.57V171.43H494.008Z%22%20fill%3D%22%23F0047F%22%2F%3E%3C%2Fg%3E%3Cdefs%3E%3CclipPath%20id%3D%22clip0_1_2%22%3E%3Crect%20width%3D%221000%22%20height%3D%221000%22%20fill%3D%22white%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3C%2Fsvg%3E) 0 0 / 100% 100%"
  >
    <div class="absolute inset-0">
      <div id="jamstack-dots-container" class={cn('relative', sizeClasses)} data-color={colorLogo}>
      </div>
    </div>
  </div>
</div>

<script>
  import { DotsBlock } from '@/lib/dots/dots-block';
  document.addEventListener('astro:page-load', () => {
    const logoColor = document
      .querySelector('#jamstack-dots-container')
      ?.getAttribute('data-color');
    const logoColorRgb = logoColor?.split(',').map(Number);
    new DotsBlock(document.querySelector('#jamstack-dots-container') as HTMLElement, [
      logoColorRgb!,
    ]);
  });
</script>
